# PRD ‚Äî ¬´4 –¥—Ä—É–∑–µ–π + –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã¬ª

## 1) –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
–¢–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç, –≥–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –æ–¥–Ω–æ–≥–æ –∏–∑ 4 –¥—Ä—É–∑–µ–π (–Ø–Ω, –ù–∞—Ç–∞—à–∞, –ê–Ω—è, –ú–∞–∫—Å) –∏–ª–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–Ω—ã–π —Ä–µ–∂–∏–º.

–¶–µ–Ω–Ω–æ—Å—Ç—å MVP:
- –±—ã—Å—Ç—Ä—ã–π ¬´—Ä–∞–∑–≥–æ–≤–æ—Ä–Ω—ã–π¬ª –æ—Ç–≤–µ—Ç –≤ —Ç–æ–Ω–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –¥—Ä—É–≥–∞;
- —Ä–µ–∂–∏–º `–í—Å–µ –≤–∑–≥–ª—è–¥—ã` –¥–ª—è 4 —Ä–∞–∑–Ω—ã—Ö —Ç–æ—á–µ–∫ –∑—Ä–µ–Ω–∏—è;
- —É—Ç–∏–ª–∏—Ç–∞—Ä–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –¥–ª—è socially awkward –∫–µ–π—Å–æ–≤: `–°—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π`, `–û—Ç–≤–µ—Ç—å`, `–°–≤–æ–¥–∫–∞`.

## 2) –¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è (MVP)
- –ª—é–¥–∏, –∫–æ—Ç–æ—Ä—ã–º —Ç—Ä—É–¥–Ω–æ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è;
- –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–º –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–∏, –∫–æ—Ç–æ—Ä—ã–º –Ω—É–∂–µ–Ω –±—ã—Å—Ç—Ä—ã–π —è—Å–Ω—ã–π –æ—Ç–≤–µ—Ç;
- –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é—â–∏–µ low-friction UI –≤ Telegram.

## 3) Goals
- –î–∞—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–π UX: ¬´–¥—Ä—É–∑—å—è¬ª –∏ ¬´–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã¬ª —Ä–∞–∑–¥–µ–ª–µ–Ω—ã.
- –°–æ—Ö—Ä–∞–Ω—è—Ç—å –æ—Ç–ª–∏—á–∏–º—ã–µ –≥–æ–ª–æ—Å–∞ 4 –¥—Ä—É–∑–µ–π.
- –î–∞—Ç—å –ø–æ–ª–µ–∑–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞ 1-2 —à–∞–≥–∞.
- –°–æ—Ö—Ä–∞–Ω—è—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å.

## 4) Non-goals
- –ù–∏–∫–∞–∫–∏—Ö –¥–∏–∞–≥–Ω–æ–∑–æ–≤ –∏ –º–µ–¥/—é—Ä–∏–¥/—Ñ–∏–Ω-–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π.
- –ù–∏–∫–∞–∫–æ–≥–æ web UI –≤ MVP.
- –ù–∏–∫–∞–∫–æ–π –ø—É–±–ª–∏—á–Ω–æ–π —Å–æ—Ü-–º–µ—Ö–∞–Ω–∏–∫–∏.

## 5) Core modes
- `SINGLE`: –æ—Ç–≤–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –¥—Ä—É–≥–∞.
- `PANEL`: –æ—Ç–≤–µ—Ç—ã 4 –¥—Ä—É–∑–µ–π (–±–µ–∑ –ò–Ω–Ω—ã).
- `SUMMARY`: tool-flow `üìã –°–≤–æ–¥–∫–∞`.
- `CRISIS`: —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π safety –æ—Ç–≤–µ—Ç.
- `SINGLE+scenario=compose`: –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç `üìù –°—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π`.
- `SINGLE+scenario=reply`: –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç `üí¨ –û—Ç–≤–µ—Ç—å`.

## 6) User stories
- –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, —è –≤—ã–±–∏—Ä–∞—é –¥—Ä—É–≥–∞ –∏ –ø–∏—à—É –∫–∞–∫ –≤ –æ–±—ã—á–Ω–æ–º —á–∞—Ç–µ.
- –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, —è –∑–∞–ø—É—Å–∫–∞—é `üöÄ –í—Å–µ –≤–∑–≥–ª—è–¥—ã` –∏ –ø–æ–ª—É—á–∞—é 4 —Ä–∞–∑–Ω—ã—Ö –æ—Ç–≤–µ—Ç–∞.
- –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, —è –∑–∞–ø—É—Å–∫–∞—é `üìù –°—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π` –∏ –ø–æ–ª—É—á–∞—é –≥–æ—Ç–æ–≤—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã —Å–æ–æ–±—â–µ–Ω–∏—è.
- –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, —è –∑–∞–ø—É—Å–∫–∞—é `üí¨ –û—Ç–≤–µ—Ç—å` –∏ –ø–æ–ª—É—á–∞—é –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –≤—Ö–æ–¥—è—â–µ–µ.
- –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, —è –∑–∞–ø—É—Å–∫–∞—é `üìã –°–≤–æ–¥–∫–∞` –∏ –ø–æ–ª—É—á–∞—é –∫–æ—Ä–æ—Ç–∫–∏–π –∏—Ç–æ–≥ —Å —à–∞–≥–∞–º–∏.

## 7) Functional requirements
### 7.1 UX / keyboard
- –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è reply-–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞:
  - `üöÄ –í—Å–µ –≤–∑–≥–ª—è–¥—ã` `üë• –î—Ä—É–∑—å—è`
  - `üìù –°—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π` `üí¨ –û—Ç–≤–µ—Ç—å`
  - `üìã –°–≤–æ–¥–∫–∞` `‚ùì –ü–æ–º–æ—â—å`
  - `‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏`

### 7.2 Session logic
- `currentPersona` sticky –¥–æ —è–≤–Ω–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è.
- –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –Ω–µ —Å–±—Ä–∞—Å—ã–≤–∞—é—Ç –≤—ã–±—Ä–∞–Ω–Ω—É—é –ø–µ—Ä—Å–æ–Ω—É.
- Pending —Ä–µ–∂–∏–º—ã:
  - `awaiting_panel_input`
  - `awaiting_compose_input`
  - `awaiting_reply_input`
- `SUMMARY` –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è one-click –±–µ–∑ pending state.

### 7.3 Safety
- hard/soft safety detection.
- hard -> fixed crisis text.
- soft -> safety check flow —Å resume.

### 7.4 Data
- session memory: rolling summary + –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è.
- long-term memory: `fact/preference/thread/episode`.
- `/reset` -> session state reset.
- `/forget` -> long-term reset.

## 8) Acceptance criteria
- PANEL –≤—Å–µ–≥–¥–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–æ–≤–Ω–æ 4 –±–ª–æ–∫–∞ –¥—Ä—É–∑–µ–π.
- SUMMARY –≤—ã–≤–æ–¥–∏—Ç—Å—è –∫–∞–∫ `üìã –°–≤–æ–¥–∫–∞`.
- `compose` –∏ `reply` —Ä–∞–±–æ—Ç–∞—é—Ç —á–µ—Ä–µ–∑ –æ—Ç–¥–µ–ª—å–Ω—ã–µ scenario prompts.
- `npm run test`, `npm run lint`, `npm run build` –ø—Ä–æ—Ö–æ–¥—è—Ç.

## 9) Out of scope (current iteration)
- –†–µ–ø–µ—Ç–∏—Ü–∏—è —Ä–∞–∑–≥–æ–≤–æ—Ä–∞ (multi-turn rehearsal).
- NLP-—Ä–æ—É—Ç–∏–Ω–≥ —Å–ª–æ–∂–Ω—ã—Ö intent-–∫–ª–∞—Å—Å–æ–≤ –±–µ–∑ –∫–Ω–æ–ø–æ–∫.
- –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç `–†–∞–∑–±–æ—Ä` –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ä–µ–∂–∏–º.
